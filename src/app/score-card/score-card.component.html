<div class="main">
  <div class="scorecard" *ngIf="hideTable">
    <div class="top-content d-flex">
      <div class="first-team d-flex justify-content-start">
        <div class="team-logo me-4" style="background-color: rgb(190, 66, 66)">
          <img src="/ipl-team-logo/rcb.png" height="100px" alt="logo" />
        </div>
        <div
          class="score d-flex flex-column justify-content-center align-items-center"
        >
          <h3>SRH</h3>
          <h5>{{ firstInnings.runs }}-{{ firstInnings.wickets }}</h5>
          <h5>Overs: {{ firstInnings.overs.toFixed(1) }}</h5>
        </div>
      </div>

      <div class="status me-4">
        <h1>{{ isFirstInnings ? "1st Innings" : "2nd Innings" }}</h1>
      </div>

      <div class="second-team d-flex justify-content-end">
        <div
          class="score d-flex flex-column justify-content-center align-items-center me-4"
        >
          <h3>DC</h3>
          <h5 *ngIf="isFirstInnings">Yet to bat</h5>
          <h5 *ngIf="!isFirstInnings">
            {{ secondInnings.runs }}-{{ secondInnings.wickets }}
          </h5>
          <h5 *ngIf="!isFirstInnings">
            Overs: {{ secondInnings.overs.toFixed(1) }}
          </h5>
        </div>
        <div class="team-logo" style="background-color: rgb(174, 168, 60)">
          <img src="/ipl-team-logo/csk.png" height="120px" alt="logo" />
        </div>
      </div>
    </div>

    <div class="mid-content">
      <div class="score-timeline d-flex">
        <h4 class="m-0 mt-1">Last 6 balls:</h4>
        <div class="last-6-balls ms-4">
          <div
            *ngFor="let ball of currentInnings.lastBalls.slice(-6)"
            [ngClass]="getBallClass(ball)"
          >
            {{ ball }}
          </div>
        </div>
      </div>
      <img src="stadium.jpg" alt="stadium-image" height="200px" width="100%" />
    </div>

    <div class="bottom-content">
      <div class="players">
        <div class="batting-team-player-one">
          <div
            class="top d-flex justify-content-center"
            [ngClass]="{
              'yellow-bg': isFirstInnings,
              'red-bg': !isFirstInnings
            }"
          >
            <img src="/rr-team/sanju.avif" alt="" height="100px" />
            <div class="runs">
              <h2>
                {{ teams.firstTeam["players"][playerOneIndex].batting.runs }}
                ({{ teams.firstTeam["players"][playerOneIndex].batting.balls }})
                <span *ngIf="onSriker === 'player-one'">*</span>
              </h2>
              <div>
                4s:{{
                  teams.firstTeam["players"][playerOneIndex].batting.fours
                }}
                6s:{{
                  teams.firstTeam["players"][playerOneIndex].batting.sixes
                }}
                sr:
                {{
                  teams.firstTeam["players"][playerTwoIndex].batting.sr
                    | number : "1.2-2"
                }}
              </div>
            </div>
          </div>
          <div class="player-name">
            <h2>{{ selectedPlayer1 }}</h2>
          </div>
        </div>

        <div class="batting-team-player-two">
          <div
            class="top d-flex justify-content-center"
            [ngClass]="{
              'yellow-bg': isFirstInnings,
              'red-bg': !isFirstInnings
            }"
          >
            <img src="/rr-team/hetmyre.webp" alt="" height="100px" />
            <div class="runs">
              <h2>
                {{ teams.firstTeam["players"][playerTwoIndex].batting.runs }}
                ({{ teams.firstTeam["players"][playerTwoIndex].batting.balls }})
                <span *ngIf="onSriker === 'player-two'">*</span>
              </h2>
              <div>
                4s:{{
                  teams.firstTeam["players"][playerTwoIndex].batting.fours
                }}
                6s:{{
                  teams.firstTeam["players"][playerTwoIndex].batting.sixes
                }}
                sr:
                {{
                  teams.firstTeam["players"][playerTwoIndex].batting.sr
                    | number : "1.2-2"
                }}
              </div>
            </div>
          </div>
          <div class="player-name">
            <h2>{{ selectedPlayer2 }}</h2>
          </div>
        </div>

        <div class="current-bowler">
          <div
            class="top d-flex justify-content-center"
            [ngClass]="{
              'yellow-bg': !isFirstInnings,
              'red-bg': isFirstInnings
            }"
          >
            <img src="/rr-team/hetmyre.webp" alt="" height="100px" />
            <div class="runs">
              <h2>
                {{
                  teams.secondTeam["players"][curBowlerId].bowling.runsConceded
                }}
                -
                {{ teams.secondTeam["players"][curBowlerId].bowling.wickets }}
              </h2>
              <div>
                Overs:({{
                  teams.secondTeam["players"][curBowlerId].bowling.overs
                }}) Eco:
                {{ teams.secondTeam["players"][curBowlerId].bowling.economy }}
              </div>
            </div>
          </div>
          <div class="player-name">
            <h2>{{ selectedBowler }}</h2>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- ##################  Batting scorcard ################## -->
  <table
    class="table table-bordered table-striped text-center p-3"
    *ngIf="!hideTable"
  >
    <thead class="table-dark">
      <tr>
        <th>Player</th>
        <th>Status</th>
        <th>Runs (Balls)</th>
        <th>Strike Rate</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let player of teams.firstTeam.players">
        <td>{{ player.name }}</td>
        <td>{{ player.batting.out === true ? "Out" : "" }}</td>
        <td>{{ player.batting.runs }} ({{ player.batting.balls }})</td>
        <td>{{ player.batting.sr.toFixed(2) }}</td>
      </tr>
    </tbody>
    <tfoot class="table-secondary fw-bold">
      <tr>
        <td>Total</td>
        <td>
          <h5>{{ firstInnings.runs }}-{{ firstInnings.wickets }}</h5>
        </td>
        <td>Overs: {{ firstInnings.overs.toFixed(1) }}</td>
      </tr>
    </tfoot>
  </table>
  <!-- ##################  Bowling scorcard ################## -->
  <table
    class="table table-bordered table-striped text-center p-3"
    *ngIf="!hideTable"
  >
    <thead class="table-dark">
      <tr>
        <th>Player</th>
        <th>Overs</th>
        <th>Runs</th>
        <th>Wickets</th>
        <th>Economy</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let player of teams.secondTeam.players">
        <tr *ngIf="player.bowling.runsConceded > 0">
          <td>{{ player.name }}</td>
          <td>{{ player.bowling.overs }}</td>
          <td>{{ player.bowling.runsConceded }}</td>
          <td>{{ player.bowling.wickets }}</td>
          <td>{{ player.bowling.economy.toFixed(2) }}</td>
        </tr>
      </ng-container>
    </tbody>
    <tfoot class="table-secondary fw-bold">
      <tr>
        <td>Total</td>
        <td>
          <h5>{{ firstInnings.runs }}-{{ firstInnings.wickets }}</h5>
        </td>
        <td>Overs: {{ firstInnings.overs.toFixed(1) }}</td>
      </tr>
    </tfoot>
  </table>
  <!-- Score Update Buttons -->
  <div class="right-side">
    <div class="player-selection">
      <div class="mb-3">
        <label class="w-25" for="player1">Select Batsman 1</label>
        <select
          class="w-50"
          id="player1"
          [(ngModel)]="selectedPlayer1"
          [value]="selectedPlayer1"
        >
          <option
            *ngFor="let player of batsOneList"
            [value]="player.name"
            [disabled]="
              player.name === selectedPlayer2 || player.batting.out === true
            "
          >
            {{ player.name }}
          </option>
        </select>
      </div>

      <div class="mb-3">
        <label class="w-25" for="player2">Select Batsman 2</label>
        <select
          class="w-50"
          id="player2"
          [(ngModel)]="selectedPlayer2"
          [value]="selectedPlayer2"
        >
          <option
            *ngFor="let player of batsTwoList"
            [value]="player.name"
            [disabled]="
              player.name === selectedPlayer1 || player.batting.out === true
            "
          >
            {{ player.name }}
          </option>
        </select>
      </div>

      <div class="mb-3">
        <label class="w-25" for="bowler">Select Bowler</label>
        <select
          class="w-50"
          id="bowler"
          [(ngModel)]="selectedBowler"
          [value]="selectedBowler"
        >
          <option
            *ngFor="let player of bowlerList"
            [value]="player.name"
            [disabled]="player.overs === 4"
          >
            {{ player.name }}
          </option>
        </select>
      </div>
    </div>
    <div
      class="buttons mt-5"
      *ngIf="selectedBowler && selectedPlayer1 && selectedPlayer2"
    >
      <button (click)="updateScore(0)">0</button>
      <button (click)="updateScore(1)">1</button>
      <button (click)="updateScore(2)">2</button>
      <button (click)="updateScore(3)">3</button>
      <button (click)="updateScore(4)">4</button>
      <button (click)="updateScore(6)">6</button>
      <button (click)="updateWicket()">W</button>
      <button (click)="updateExtra('NB')">NB</button>
      <!-- <button (click)="updateExtra('WD')">WD</button> -->
      <button (click)="updateOvers()">Next Ball</button>
      <button (click)="updateExtra('WD', 0)">WD</button>
      <button (click)="updateExtra('WD', 1)">WD+1</button>
      <button (click)="updateExtra('WD', 2)">WD+2</button>
      <button (click)="updateExtra('WD', 4)">WD+4</button>

      <!-- No Ball (Extra 1 Run) -->
      <button (click)="updateExtra('NB', 0)">NB</button>
      <button (click)="updateExtra('NB', 1)">NB+1</button>
      <button (click)="updateExtra('NB', 2)">NB+2</button>
      <button (click)="updateExtra('NB', 4)">NB+4</button>
      <button (click)="updateExtra('NB', 6)">NB+6</button>

      <!-- Leg Byes (Counts as a Legal Delivery) -->
      <button (click)="updateExtra('LB', 1)">LB+1</button>
      <button (click)="updateExtra('LB', 2)">LB+2</button>
      <button (click)="updateExtra('LB', 4)">LB+4</button>
      <button (click)="hideTable = !hideTable">Scorecard</button>
    </div>
  </div>
</div>
